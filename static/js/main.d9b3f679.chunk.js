(this.webpackJsonptwitclone=this.webpackJsonptwitclone||[]).push([[0],{103:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(33),c=n.n(s),o=n(91),i=(n(103),n(12)),u=n(4),d=n(17),l=Object(u.d)({name:"auth",initialState:{isLoggedIn:!1,user:""},reducers:{login:function(e,t){e.isLoggedIn=!0,e.user=t.payload.user},logout:function(e){e.isLoggedIn=!1,e.user=""}}}),p=l.actions,f=p.login,m=p.logout,j=l.reducer,b=n(30),h=n(26),O=n(5),g=n.n(O),x=n(8),_="https://safe-wave-92099.herokuapp.com",v={"Content-Type":"application/json"},P=function(){var e=Object(x.a)(g.a.mark((function e(t,n){var r,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/posts/createComment",r={post_id:t,content:n},e.next=4,fetch("https://safe-wave-92099.herokuapp.com/posts/createComment",{method:"POST",headers:v,credentials:"include",body:JSON.stringify(r)});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(x.a)(g.a.mark((function e(t){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_+"/posts/".concat(t,"/comments"),e.next=3,fetch(n,{method:"GET",headers:v,credentials:"include"});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=Object(u.d)({name:"feed",initialState:[],reducers:{addPostToTop:function(e,t){return[t.payload].concat(Object(h.a)(e))},setPosts:function(e,t){return t.payload.posts},clearFeed:function(e){return[]},feedLikePost:function(e,t){return e.map((function(e){return e.post_id===t.payload.post_id?Object(b.a)(Object(b.a)({},e),{},{liked:!0,like_count:e.like_count+1}):e}))},feedUnlikePost:function(e,t){return e.map((function(e){return e.post_id===t.payload.post_id?Object(b.a)(Object(b.a)({},e),{},{liked:!1,like_count:e.like_count-1}):e}))}}}),y=w.actions,S=(y.addPostToTop,y.setPosts,y.clearFeed,y.feedLikePost,y.feedUnlikePost,w.reducer),N=n(61),C=n(75),T=n(25),F=Object(C.a)({reducerPath:"api",baseQuery:Object(T.d)({baseUrl:"https://safe-wave-92099.herokuapp.com/",credentials:"include"}),tagTypes:["Post"],endpoints:function(e){return{getAllPosts:e.query({query:function(){return"posts/getAllPosts"},providesTags:["Post"]}),getSubPosts:e.query({query:function(){return"posts/getSubscribedPosts"},providesTags:["Post"]}),createPost:e.mutation({query:function(e){return{url:"posts/new",method:"POST",body:e}},invalidatesTags:["Post"]}),likePost:e.mutation({query:function(e){return{url:"posts/likePost",method:"POST",body:{post_id:e}}},onQueryStarted:function(e,t){return Object(x.a)(g.a.mark((function n(){var r;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.dispatch,t.queryFulfilled;try{r(F.util.updateQueryData("getAllPosts",void 0,(function(t){console.log("patching"),t.forEach((function(t){t.post_id===e&&(t.like_count++,t.liked=!0)}))}))),r(F.util.updateQueryData("getSubPosts",void 0,(function(t){console.log("patching"),t.forEach((function(t){t.post_id===e&&(t.like_count++,t.liked=!0)}))})))}catch(a){console.log(a)}case 2:case"end":return n.stop()}}),n)})))()}}),unlikePost:e.mutation({query:function(e){return{url:"posts/unlikePost",method:"POST",body:{post_id:e}}},onQueryStarted:function(e,t){return Object(x.a)(g.a.mark((function n(){var r;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.dispatch,t.queryFulfilled;try{r(F.util.updateQueryData("getAllPosts",void 0,(function(t){console.log("patching"),t.forEach((function(t){t.post_id===e&&(t.like_count--,t.liked=!1)}))}))),r(F.util.updateQueryData("getSubPosts",void 0,(function(t){console.log("patching"),t.forEach((function(t){t.post_id===e&&(t.like_count--,t.liked=!1)}))})))}catch(a){console.log(a)}case 2:case"end":return n.stop()}}),n)})))()}})}}}),L=F.useGetAllPostsQuery,U=F.useGetSubPostsQuery,q=F.useCreatePostMutation,D=F.useLikePostMutation,A=F.useUnlikePostMutation,E=n(77),Q={key:"root",storage:n.n(E).a,whitelist:["auth"]},J=Object(d.b)(Object(i.a)({auth:j,feed:S},F.reducerPath,F.reducer)),M=Object(N.a)(Q,J),G=Object(u.a)({reducer:M,middleware:function(e){return e().concat(F.middleware)}}),I=n(18),H=n(42),Z=n.n(H),B=n(10),K=function(){return Object(I.d)()},R=I.e,W=function(){var e=Object(x.a)(g.a.mark((function e(t,n){var r,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/account/login",r={user:t,pass:n},e.next=4,fetch("https://safe-wave-92099.herokuapp.com/account/login",{credentials:"include",method:"POST",headers:v,body:JSON.stringify(r)});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),X=function(){var e=Object(x.a)(g.a.mark((function e(t,n){var r,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/account/register",r={user:t,pass:n},e.next=4,fetch("https://safe-wave-92099.herokuapp.com/account/register",{method:"POST",headers:v,body:JSON.stringify(r)});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(x.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/account/logout",e.next=3,fetch("https://safe-wave-92099.herokuapp.com/account/logout",{method:"POST",headers:v,credentials:"include"});case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=n(79),V=n.n(Y),$=n(1),ee=function(){var e=Object(B.g)(),t=K(),n=function(){var t=Object(x.a)(g.a.mark((function t(n){var r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.target.id,e.push(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){var e=Object(x.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:t(m());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object($.jsxs)("div",{className:Z.a["sidebar-container"],children:[Object($.jsx)("div",{className:Z.a["sidebar-logo"],children:Object($.jsx)(V.a,{style:{fontSize:"40px"}})}),Object($.jsx)("div",{onClick:n,id:"/all",className:Z.a["sidebar-item"],children:"All Posts"}),Object($.jsx)("div",{onClick:n,id:"/subscribed",className:Z.a["sidebar-item"],children:"Subscribed Posts"}),Object($.jsx)("div",{onClick:r,className:"".concat(Z.a["sidebar-item"]," ").concat(Z.a["sidebar-logout"]),children:"Logout"})]})},te=n(45),ne=n.n(te),re=n(7),ae=n(39),se=n.n(ae),ce=n(139),oe=n(141);function ie(e){var t,n=0;for(t=0;t<e.length;t+=1)n=e.charCodeAt(t)+((n<<5)-n);var r="#";for(t=0;t<3;t+=1){r+="00".concat((n>>8*t&255).toString(16)).substr(-2)}return r}function ue(e){return{sx:{bgcolor:ie(e)},children:e[0].toUpperCase()+e[1]}}var de=function(){var e=Object(r.useState)(""),t=Object(re.a)(e,2),n=t[0],a=t[1],s=R((function(e){return e.auth.user})),c=Object(r.useState)(""),o=Object(re.a)(c,2),i=o[0],u=o[1],d=q(),l=Object(re.a)(d,2),p=l[0],f=(l[1].isLoading,K(),function(){var e=Object(x.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({content:n,image:i}).unwrap();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object($.jsxs)("div",{className:se.a["post-form-outer-container"],children:[Object($.jsx)(oe.a,Object(b.a)({className:se.a["post-form-avatar"]},ue(s))),Object($.jsxs)("div",{className:se.a["post-form-container"],children:[Object($.jsx)("textarea",{placeholder:"Whats Happening?",className:se.a["post-text-area"],onChange:function(e){return a(e.target.value)}}),Object($.jsxs)("div",{className:se.a["post-submit-container"],children:[Object($.jsx)("input",{onChange:function(e){return u(e.target.value)},className:se.a["post-image-input"],type:"text",placeholder:"Image URL(optional)"}),Object($.jsx)(ce.a,{className:se.a["post-form-button"],onClick:f,variant:"contained",children:"Post"})]})]})]})},le=n(24),pe=n.n(le),fe=n(53),me=n.n(fe),je=function(e){var t=e.comments,n=e.post_id,a=e.refreshCom,s=Object(r.useState)(""),c=Object(re.a)(s,2),o=c[0],i=c[1],u=function(){var e=Object(x.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(n,o);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(x.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==t.which){e.next=5;break}return t.preventDefault(),e.next=4,u();case 4:a();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object($.jsxs)("div",{className:me.a["comments-container"],children:[Object($.jsx)("div",{className:me.a["comments-input-container"],children:Object($.jsx)("textarea",{onKeyPress:d,onChange:function(e){return i(e.target.value)},className:me.a["comments-input"]})}),t.map((function(e){return Object($.jsxs)("div",{className:me.a["comments-comment"],children:[e.username,Object($.jsx)("p",{children:e.content})]})}))]})},be=n(86),he=n.n(be),Oe=n(85),ge=n.n(Oe),xe=n(87),_e=n.n(xe),ve=n(138),Pe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ke=function(e){var t=e.post,n=Object(r.useState)(!1),a=Object(re.a)(n,2),s=a[0],c=a[1],o=Object(r.useState)([]),i=Object(re.a)(o,2),u=i[0],d=i[1],l=D(),p=Object(re.a)(l,1)[0],f=A(),m=Object(re.a)(f,1)[0],j=Object(r.useState)(!1),h=Object(re.a)(j,2),O=h[0],_=h[1],v=(K(),new Date(t.created_at)),P=new Date,w=Math.round(Math.abs(v.getTime()-P.getTime())/36e5)-8,y=function(){var e=Object(x.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t.post_id);case 2:n=e.sent,console.log(n),d(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(x.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O||y(),_(!O);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object($.jsxs)("div",{className:pe.a["post-outer-container"],children:[Object($.jsx)(oe.a,Object(b.a)({className:pe.a["post-avatar"]},ue(t.username))),Object($.jsxs)("div",{className:pe.a["post-container"],children:[Object($.jsxs)("div",{onClick:S,children:[Object($.jsx)("div",{className:pe.a["post-header"],children:Object($.jsxs)("div",{className:pe.a["user-name-container"],children:[Object($.jsx)("div",{className:pe.a.username,children:t.username}),Object($.jsxs)("div",{className:pe.a.screenname,children:["@",t.screen_name]}),Object($.jsx)("div",{className:pe.a.screenname,children:w>24?"".concat(Pe[v.getMonth()]," ").concat(v.getDay()):"".concat(w,"h")})]})}),Object($.jsx)("p",{children:t.content}),null!==t.image_url&&Object($.jsx)("img",{onClick:function(){return c(!0)},className:pe.a["post-image"],src:t.image_url,alt:t.username}),Object($.jsxs)("div",{className:pe.a["post-footer"],children:[Object($.jsxs)("div",{className:pe.a["comment-ind-container"],children:[Object($.jsx)(ge.a,{}),Object($.jsx)("span",{children:t.comment_count})]}),Object($.jsxs)("div",{className:t.liked?pe.a["material-icon-heart"]:pe.a["material-icon-border-heart"],children:[t.liked?Object($.jsx)(he.a,{onClick:function(e){e.stopPropagation(),m(t.post_id)}}):Object($.jsx)(_e.a,{onClick:function(e){e.stopPropagation(),p(t.post_id)}}),Object($.jsx)("span",{children:t.like_count})]})]})]}),O&&Object($.jsx)(je,{refreshCom:y,post_id:t.post_id,comments:u}),null!==t.image_url&&Object($.jsx)(ve.a,{open:s,onClose:function(){return c(!1)},children:Object($.jsx)("img",{className:pe.a["modal-image"],src:t.image_url,alt:t.username})})]})]})},we=n(142),ye=function(){K(),R((function(e){return e.auth.user}));var e,t=L(),n=t.data,r=t.isLoading,a=t.isSuccess;t.isError,t.error;return r?e=Object($.jsx)(we.a,{}):a&&(e=n.map((function(e,t){return Object($.jsx)(ke,{post:e})}))),console.log(n),Object($.jsxs)("div",{className:ne.a["feed-container"],children:[Object($.jsx)("h3",{className:ne.a["feed-header"],children:"Home"}),Object($.jsx)(de,{}),e]})},Se=n(93),Ne=["children"],Ce=function(e){var t=e.children,n=Object(Se.a)(e,Ne),r=R((function(e){return e.auth.isLoggedIn}));return Object($.jsx)(B.b,Object(b.a)(Object(b.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object($.jsx)(B.a,{to:{pathname:"/login",state:{from:n}}})}}))},Te=n(43),Fe=n.n(Te),Le=function(){var e=Object(r.useState)(""),t=Object(re.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(""),c=Object(re.a)(s,2),o=c[0],i=c[1],u=R((function(e){return e.auth.isLoggedIn})),d=Object(B.g)(),l=K(),p=function(){var e=Object(x.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,W(n,o);case 3:202===e.sent.status&&(l(f({user:n})),d.push("/feed"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(x.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,X(n,o);case 3:if(202!==e.sent.status){e.next=9;break}return e.next=7,W(n,o);case 7:202===e.sent.status&&(l(f({user:n})),d.push("/all"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return u?Object($.jsx)(B.a,{to:"/all"}):Object($.jsxs)("form",{className:Fe.a["login-form-container"],children:[Object($.jsx)("label",{children:Object($.jsx)("b",{children:"Username"})}),Object($.jsx)("input",{className:Fe.a["login-form-input"],onChange:function(e){return a(e.target.value)},placeholder:"Username",type:"text"}),Object($.jsx)("label",{children:Object($.jsx)("b",{children:"Password"})}),Object($.jsx)("input",{className:Fe.a["login-form-input"],onChange:function(e){return i(e.target.value)},placeholder:"Password",type:"password"}),Object($.jsx)("button",{className:"".concat(Fe.a["login-form-input"]," ").concat(Fe.a["login-form-button"]),onClick:p,children:"Submit"}),Object($.jsx)("button",{className:Fe.a["login-form-input"],onClick:m,children:"Sign Up"})]})},Ue=n(88),qe=n.n(Ue),De=n(60),Ae=n.n(De),Ee=function(){var e=Object(x.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/user/suggestedUsers",e.next=3,fetch("https://safe-wave-92099.herokuapp.com/user/suggestedUsers",{type:"cors",method:"GET",headers:v,credentials:"include"});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qe=function(){var e=Object(x.a)(g.a.mark((function e(t){var n,r,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _+"/user/followUser",n={target:t},e.next=4,fetch("https://safe-wave-92099.herokuapp.com/user/followUser",{method:"POST",headers:v,credentials:"include",body:JSON.stringify(n)});case 4:return r=e.sent,e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Je=function(e){var t=e.username;return Object($.jsxs)("div",{className:Ae.a["suggested-entry"],children:[t,Object($.jsx)("button",{onClick:function(){Qe(t)},children:"Follow"})]})},Me=function(){var e=Object(r.useState)([]),t=Object(re.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(x.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object($.jsxs)("div",{className:Ae.a["widget-container"],children:[Object($.jsx)("h5",{children:"Suggested Users"}),n.map((function(e,t){return Object($.jsx)(Je,{username:e.username},e.username)}))]})},Ge=n(89),Ie=n.n(Ge),He=function(){return Object($.jsx)("div",{className:Ie.a["sidebar-container"],children:Object($.jsx)(Me,{})})},Ze=function(){var e,t=U(),n=t.data,r=t.isLoading,a=t.isSuccess;return r?e=Object($.jsx)(we.a,{}):a&&(e=n.map((function(e,t){return Object($.jsx)(ke,{post:e})}))),Object($.jsxs)("div",{className:ne.a["feed-container"],children:[Object($.jsx)("h3",{className:ne.a["feed-header"],children:"Home"}),Object($.jsx)(de,{}),e]})},Be=function(){return Object($.jsx)("div",{className:qe.a["app-container"],children:Object($.jsxs)(B.d,{children:[Object($.jsx)(B.b,{path:"/login",children:Object($.jsx)(Le,{})}),Object($.jsxs)(Ce,{path:"/all",children:[Object($.jsx)(ee,{}),Object($.jsx)(ye,{}),Object($.jsx)(He,{})]}),Object($.jsxs)(Ce,{path:"/subscribed",children:[Object($.jsx)(ee,{}),Object($.jsx)(Ze,{}),Object($.jsx)(He,{})]}),Object($.jsx)(Ce,{path:"/",children:Object($.jsx)(B.a,{to:"/all"})})]})})},Ke=n(90),Re=Object(N.b)(G);c.a.render(Object($.jsx)(a.a.StrictMode,{children:Object($.jsx)(I.a,{store:G,children:Object($.jsx)(Ke.a,{loading:null,persistor:Re,children:Object($.jsx)(o.a,{basename:"/message-board",children:Object($.jsx)(Be,{})})})})}),document.getElementById("root"))},24:function(e,t,n){e.exports={"post-container":"Post_post-container__1eauk","post-image":"Post_post-image__1eJ1c","post-header":"Post_post-header__1RNuL","material-icon-heart":"Post_material-icon-heart__2TuZ3","material-icon-border-heart":"Post_material-icon-border-heart__Gei2f","post-footer":"Post_post-footer__THcfM","comment-ind-container":"Post_comment-ind-container__DWjBB","modal-image":"Post_modal-image__1AGpc","user-name-container":"Post_user-name-container__3UKS6",username:"Post_username__uDN1e",screenname:"Post_screenname__fiKFS","post-avatar":"Post_post-avatar__1h6T7","post-outer-container":"Post_post-outer-container__nvX_u"}},39:function(e,t,n){e.exports={"post-text-area":"PostForm_post-text-area__2tqHQ","post-form-container":"PostForm_post-form-container__2adad","post-form-outer-container":"PostForm_post-form-outer-container__21ASL","post-form-avatar":"PostForm_post-form-avatar__qfdX1","post-submit-container":"PostForm_post-submit-container__2C7HZ","post-image-input":"PostForm_post-image-input__3-g9l","post-form-button":"PostForm_post-form-button__27-oG"}},42:function(e,t,n){e.exports={"sidebar-container":"Sidebar_sidebar-container__3ve-Y","sidebar-logo":"Sidebar_sidebar-logo__2qQro","sidebar-item":"Sidebar_sidebar-item__3tqF5","sidebar-logout":"Sidebar_sidebar-logout__29fYi"}},43:function(e,t,n){e.exports={"login-form-container":"LoginPage_login-form-container__2uptE","login-form-input":"LoginPage_login-form-input__10So9","login-form-button":"LoginPage_login-form-button__3hphZ"}},45:function(e,t,n){e.exports={"feed-container":"Feed_feed-container__24Wie","feed-header":"Feed_feed-header__3uiu4"}},53:function(e,t,n){e.exports={"comments-container":"PostComments_comments-container__3uFEf","comments-input-container":"PostComments_comments-input-container__3dFH5","comments-input":"PostComments_comments-input__ow6cX","comments-comment":"PostComments_comments-comment__1wGZk"}},60:function(e,t,n){e.exports={"widget-container":"Suggested_widget-container__3P3du","suggested-entry":"Suggested_suggested-entry__1F6jb"}},88:function(e,t,n){e.exports={"app-container":"app_app-container__25y9D"}},89:function(e,t,n){e.exports={"sidebar-container":"SidebarRight_sidebar-container__1zSIq"}}},[[115,1,2]]]);
//# sourceMappingURL=main.d9b3f679.chunk.js.map